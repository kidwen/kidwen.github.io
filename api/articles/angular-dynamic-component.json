{"title":"angular 动态组件应用场景","uid":"c6a94a4407c4957c896b7d4b5cf0704e","slug":"angular-dynamic-component","date":"2025-03-16T12:38:09.384Z","updated":"2025-03-16T13:04:29.542Z","comments":true,"path":"api/articles/angular-dynamic-component.json","keywords":null,"cover":"https://img.kidwen.top/file/AgACAgUAAyEGAASHUuUOAAMQZ9bNjznl2QgP8HIXmQvexo0AAa4-AAI6wjEb0Qq4VgTJ_8jLOPvfAQADAgADeAADNgQ.png","content":"<p>在 Angular 中，动态组件允许你在运行时动态地创建和插入组件，而不是在模板中静态定义。这种灵活性使得你可以根据应用的状态或用户交互来决定加载哪些组件。</p>\n<h2 id=\"关键词：\">关键词：</h2>\n<ul>\n<li><strong>ViewContainerRef</strong>：表示视图容器，用于管理动态组件的插入和移除。</li>\n<li><strong>ComponentFactoryResolver</strong>：用于解析组件的工厂，通过它可以动态创建组件实例。</li>\n<li><strong>ComponentRef</strong>：代表动态创建的组件实例。</li>\n<li><strong>TemplateRef</strong>：代表可用于创建视图的嵌入式模板。</li>\n<li><strong>Injector</strong>：为动态创建的组件提供依赖关系。</li>\n</ul>\n<h2 id=\"示例-2\">示例</h2>\n<h3 id=\"动态表单\">动态表单</h3>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>在一个form表单中根据某个下拉项选中的值显示不同的字段场景时</p></blockquote>\n<ol>\n<li>\n<p>定义动态需要显示的组件</p>\n<pre class=\"shiki github-dark\" style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#6A737D\">   // Text Input Component</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">   @</span><span style=\"color:#B392F0\">Component</span><span style=\"color:#E1E4E8\">(&#123;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     selector: </span><span style=\"color:#9ECBFF\">'app-text-input'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     template: </span><span style=\"color:#9ECBFF\">'&#x3C;input type=\"text\" placeholder=\"Enter text\">'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">   &#125;)</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">   export</span><span style=\"color:#F97583\"> class</span><span style=\"color:#B392F0\"> TextInputComponent</span><span style=\"color:#E1E4E8\"> &#123;&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\">   // Date Input Component</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">   @</span><span style=\"color:#B392F0\">Component</span><span style=\"color:#E1E4E8\">(&#123;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     selector: </span><span style=\"color:#9ECBFF\">'app-date-input'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     template: </span><span style=\"color:#9ECBFF\">'&#x3C;input type=\"date\">'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">   &#125;)</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">   export</span><span style=\"color:#F97583\"> class</span><span style=\"color:#B392F0\"> DateInputComponent</span><span style=\"color:#E1E4E8\"> &#123;&#125;</span></span></code></pre>\n</li>\n<li>\n<p>容器组件</p>\n<pre class=\"shiki github-dark\" style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">   import</span><span style=\"color:#E1E4E8\"> &#123;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     Component,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     ViewChild,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     ViewContainerRef,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     ComponentFactoryResolver,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">   &#125; </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> '@angular/core'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">   import</span><span style=\"color:#E1E4E8\"> &#123; TextInputComponent &#125; </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> './text-input.component'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">   import</span><span style=\"color:#E1E4E8\"> &#123; DateInputComponent &#125; </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> './date-input.component'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">   @</span><span style=\"color:#B392F0\">Component</span><span style=\"color:#E1E4E8\">(&#123;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     selector: </span><span style=\"color:#9ECBFF\">'app-dynamic-form'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     template: </span><span style=\"color:#9ECBFF\">`</span></span>\n<span class=\"line\"><span style=\"color:#9ECBFF\">       &#x3C;select #fieldType (change)=\"onFieldTypeChange(fieldType.value)\"></span></span>\n<span class=\"line\"><span style=\"color:#9ECBFF\">         &#x3C;option value=\"text\">Text Input&#x3C;/option></span></span>\n<span class=\"line\"><span style=\"color:#9ECBFF\">         &#x3C;option value=\"date\">Date Input&#x3C;/option></span></span>\n<span class=\"line\"><span style=\"color:#9ECBFF\">       &#x3C;/select></span></span>\n<span class=\"line\"><span style=\"color:#9ECBFF\">       &#x3C;div #container>&#x3C;/div></span></span>\n<span class=\"line\"><span style=\"color:#9ECBFF\">     `</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">   &#125;)</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">   export</span><span style=\"color:#F97583\"> class</span><span style=\"color:#B392F0\"> DynamicFormComponent</span><span style=\"color:#E1E4E8\"> &#123;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     @</span><span style=\"color:#B392F0\">ViewChild</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'container'</span><span style=\"color:#E1E4E8\">, &#123; read: ViewContainerRef, static: </span><span style=\"color:#79B8FF\">true</span><span style=\"color:#E1E4E8\"> &#125;)</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">     container</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> ViewContainerRef</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">     constructor</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#F97583\">private</span><span style=\"color:#FFAB70\"> componentFactoryResolver</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> ComponentFactoryResolver</span><span style=\"color:#E1E4E8\">) &#123;&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#B392F0\">     onFieldTypeChange</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">fieldType</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> string</span><span style=\"color:#E1E4E8\">) &#123;</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">       this</span><span style=\"color:#E1E4E8\">.container.</span><span style=\"color:#B392F0\">clear</span><span style=\"color:#E1E4E8\">();</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">       let</span><span style=\"color:#E1E4E8\"> componentFactory;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">       if</span><span style=\"color:#E1E4E8\"> (fieldType </span><span style=\"color:#F97583\">===</span><span style=\"color:#9ECBFF\"> 'text'</span><span style=\"color:#E1E4E8\">) &#123;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">         componentFactory </span><span style=\"color:#F97583\">=</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">           this</span><span style=\"color:#E1E4E8\">.componentFactoryResolver.</span><span style=\"color:#B392F0\">resolveComponentFactory</span><span style=\"color:#E1E4E8\">(TextInputComponent);</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">       &#125; </span><span style=\"color:#F97583\">else</span><span style=\"color:#F97583\"> if</span><span style=\"color:#E1E4E8\"> (fieldType </span><span style=\"color:#F97583\">===</span><span style=\"color:#9ECBFF\"> 'date'</span><span style=\"color:#E1E4E8\">) &#123;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">         componentFactory </span><span style=\"color:#F97583\">=</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">           this</span><span style=\"color:#E1E4E8\">.componentFactoryResolver.</span><span style=\"color:#B392F0\">resolveComponentFactory</span><span style=\"color:#E1E4E8\">(DateInputComponent);</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">       &#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">       if</span><span style=\"color:#E1E4E8\"> (componentFactory) &#123;</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">         this</span><span style=\"color:#E1E4E8\">.container.</span><span style=\"color:#B392F0\">createComponent</span><span style=\"color:#E1E4E8\">(componentFactory);</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">       &#125;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     &#125;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">   &#125;</span></span></code></pre>\n</li>\n</ol>\n<h3 id=\"动态弹窗\">动态弹窗</h3>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>创建一个弹窗服务，根据用户的不同操作显示不同弹窗组件</p></blockquote>\n<ol>\n<li>\n<p>弹窗组件interface</p>\n<pre class=\"shiki github-dark\" style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">   import</span><span style=\"color:#E1E4E8\"> &#123; ComponentRef &#125; </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> '@angular/core'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">   export</span><span style=\"color:#F97583\"> interface</span><span style=\"color:#B392F0\"> ModalComponent</span><span style=\"color:#E1E4E8\"> &#123;</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">     close</span><span style=\"color:#E1E4E8\">()</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> void</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">     componentRef</span><span style=\"color:#F97583\">?:</span><span style=\"color:#B392F0\"> ComponentRef</span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#79B8FF\">any</span><span style=\"color:#E1E4E8\">>;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">   &#125;</span></span></code></pre>\n</li>\n<li>\n<p>弹窗服务</p>\n<pre class=\"shiki github-dark\" style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">   import</span><span style=\"color:#E1E4E8\"> &#123;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     Injectable,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     ComponentFactoryResolver,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     ViewContainerRef,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     ComponentRef,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">   &#125; </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> '@angular/core'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">   import</span><span style=\"color:#E1E4E8\"> &#123; ModalComponent &#125; </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> './modal.component'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">   @</span><span style=\"color:#B392F0\">Injectable</span><span style=\"color:#E1E4E8\">(&#123;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     providedIn: </span><span style=\"color:#9ECBFF\">'root'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">   &#125;)</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">   export</span><span style=\"color:#F97583\"> class</span><span style=\"color:#B392F0\"> ModalService</span><span style=\"color:#E1E4E8\"> &#123;</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">     private</span><span style=\"color:#FFAB70\"> container</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> ViewContainerRef</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">     constructor</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#F97583\">private</span><span style=\"color:#FFAB70\"> componentFactoryResolver</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> ComponentFactoryResolver</span><span style=\"color:#E1E4E8\">) &#123;&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#B392F0\">     setContainer</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">container</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> ViewContainerRef</span><span style=\"color:#E1E4E8\">) &#123;</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">       this</span><span style=\"color:#E1E4E8\">.container </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> container;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     &#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#B392F0\">     open</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">component</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> any</span><span style=\"color:#E1E4E8\">)</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> ComponentRef</span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#79B8FF\">any</span><span style=\"color:#E1E4E8\">> &#123;</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">       this</span><span style=\"color:#E1E4E8\">.container.</span><span style=\"color:#B392F0\">clear</span><span style=\"color:#E1E4E8\">();</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">       const</span><span style=\"color:#79B8FF\"> factory</span><span style=\"color:#F97583\"> =</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">         this</span><span style=\"color:#E1E4E8\">.componentFactoryResolver.</span><span style=\"color:#B392F0\">resolveComponentFactory</span><span style=\"color:#E1E4E8\">(component);</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">       const</span><span style=\"color:#79B8FF\"> componentRef</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> this</span><span style=\"color:#E1E4E8\">.container.</span><span style=\"color:#B392F0\">createComponent</span><span style=\"color:#E1E4E8\">(factory);</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">       (componentRef.instance </span><span style=\"color:#F97583\">as</span><span style=\"color:#B392F0\"> ModalComponent</span><span style=\"color:#E1E4E8\">).componentRef </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> componentRef;</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">       return</span><span style=\"color:#E1E4E8\"> componentRef;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     &#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#B392F0\">     close</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">componentRef</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> ComponentRef</span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#79B8FF\">any</span><span style=\"color:#E1E4E8\">>) &#123;</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">       if</span><span style=\"color:#E1E4E8\"> (componentRef) &#123;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">         componentRef.</span><span style=\"color:#B392F0\">destroy</span><span style=\"color:#E1E4E8\">();</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">       &#125;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     &#125;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">   &#125;</span></span></code></pre>\n</li>\n<li>\n<p>使用方法</p>\n<pre class=\"shiki github-dark\" style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">   import</span><span style=\"color:#E1E4E8\"> &#123; Component, ViewChild, ViewContainerRef &#125; </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> '@angular/core'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">   import</span><span style=\"color:#E1E4E8\"> &#123; ModalService &#125; </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> './modal.service'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">   import</span><span style=\"color:#E1E4E8\"> &#123; ConfirmationModalComponent &#125; </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> './confirmation-modal.component'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">   @</span><span style=\"color:#B392F0\">Component</span><span style=\"color:#E1E4E8\">(&#123;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     selector: </span><span style=\"color:#9ECBFF\">'app-main'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     template: </span><span style=\"color:#9ECBFF\">`&#x3C;button (click)=\"openModal()\">Open Modal&#x3C;/button>&#x3C;div #modalContainer>&#x3C;/div>`</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">   &#125;)</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">   export</span><span style=\"color:#F97583\"> class</span><span style=\"color:#B392F0\"> MainComponent</span><span style=\"color:#E1E4E8\"> &#123;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     @</span><span style=\"color:#B392F0\">ViewChild</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'modalContainer'</span><span style=\"color:#E1E4E8\">, &#123; read: ViewContainerRef, static: </span><span style=\"color:#79B8FF\">true</span><span style=\"color:#E1E4E8\"> &#125;)</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">     modalContainer</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> ViewContainerRef</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">     constructor</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#F97583\">private</span><span style=\"color:#FFAB70\"> modalService</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> ModalService</span><span style=\"color:#E1E4E8\">) &#123;&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#B392F0\">     ngOnInit</span><span style=\"color:#E1E4E8\">() &#123;</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">       this</span><span style=\"color:#E1E4E8\">.modalService.</span><span style=\"color:#B392F0\">setContainer</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">this</span><span style=\"color:#E1E4E8\">.modalContainer);</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     &#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#B392F0\">     openModal</span><span style=\"color:#E1E4E8\">() &#123;</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">       this</span><span style=\"color:#E1E4E8\">.modalService.</span><span style=\"color:#B392F0\">open</span><span style=\"color:#E1E4E8\">(ConfirmationModalComponent);</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     &#125;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">   &#125;</span></span></code></pre>\n</li>\n</ol>\n<h3 id=\"CMS系统动态内容渲染\">CMS系统动态内容渲染</h3>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>CMS系统中动态的显示视频文章或者图片</p></blockquote>\n<ol>\n<li>\n<p>内容组件</p>\n<pre class=\"shiki github-dark\" style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">   @</span><span style=\"color:#B392F0\">Component</span><span style=\"color:#E1E4E8\">(&#123; selector: </span><span style=\"color:#9ECBFF\">'app-article'</span><span style=\"color:#E1E4E8\">, template: </span><span style=\"color:#9ECBFF\">'...'</span><span style=\"color:#E1E4E8\"> &#125;) </span><span style=\"color:#F97583\">export</span><span style=\"color:#F97583\"> class</span><span style=\"color:#B392F0\"> ArticleComponent</span><span style=\"color:#E1E4E8\"> &#123;&#125;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">   @</span><span style=\"color:#B392F0\">Component</span><span style=\"color:#E1E4E8\">(&#123; selector: </span><span style=\"color:#9ECBFF\">'app-video'</span><span style=\"color:#E1E4E8\">, template: </span><span style=\"color:#9ECBFF\">'...'</span><span style=\"color:#E1E4E8\"> &#125;) </span><span style=\"color:#F97583\">export</span><span style=\"color:#F97583\"> class</span><span style=\"color:#B392F0\"> VideoComponent</span><span style=\"color:#E1E4E8\"> &#123;&#125;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">   @</span><span style=\"color:#B392F0\">Component</span><span style=\"color:#E1E4E8\">(&#123; selector: </span><span style=\"color:#9ECBFF\">'app-image'</span><span style=\"color:#E1E4E8\">, template: </span><span style=\"color:#9ECBFF\">'...'</span><span style=\"color:#E1E4E8\"> &#125;) </span><span style=\"color:#F97583\">export</span><span style=\"color:#F97583\"> class</span><span style=\"color:#B392F0\"> ImageComponent</span><span style=\"color:#E1E4E8\"> &#123;&#125;</span></span></code></pre>\n</li>\n<li>\n<p>内容容器组件</p>\n<pre class=\"shiki github-dark\" style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">   import</span><span style=\"color:#E1E4E8\"> &#123; Component, ViewChild, ViewContainerRef, ComponentFactoryResolver, Input &#125; </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> '@angular/core'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">   import</span><span style=\"color:#E1E4E8\"> &#123; ArticleComponent &#125; </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> './article.component'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">   import</span><span style=\"color:#E1E4E8\"> &#123; VideoComponent &#125; </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> './video.component'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">   import</span><span style=\"color:#E1E4E8\"> &#123; ImageComponent &#125; </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> './image.component'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">   @</span><span style=\"color:#B392F0\">Component</span><span style=\"color:#E1E4E8\">(&#123;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     selector: </span><span style=\"color:#9ECBFF\">'app-content-loader'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     template: </span><span style=\"color:#9ECBFF\">'&#x3C;div #contentContainer>&#x3C;/div>'</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">   &#125;)</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">   export</span><span style=\"color:#F97583\"> class</span><span style=\"color:#B392F0\"> ContentLoaderComponent</span><span style=\"color:#E1E4E8\"> &#123;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     @</span><span style=\"color:#B392F0\">ViewChild</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'contentContainer'</span><span style=\"color:#E1E4E8\">, &#123; read: ViewContainerRef, static: </span><span style=\"color:#79B8FF\">true</span><span style=\"color:#E1E4E8\"> &#125;) </span><span style=\"color:#FFAB70\">contentContainer</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> ViewContainerRef</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     @</span><span style=\"color:#B392F0\">Input</span><span style=\"color:#E1E4E8\">() </span><span style=\"color:#FFAB70\">contentType</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> string</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">     constructor</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#F97583\">private</span><span style=\"color:#FFAB70\"> componentFactoryResolver</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> ComponentFactoryResolver</span><span style=\"color:#E1E4E8\">) &#123;&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#B392F0\">     ngOnChanges</span><span style=\"color:#E1E4E8\">() &#123;</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">         this</span><span style=\"color:#E1E4E8\">.contentContainer.</span><span style=\"color:#B392F0\">clear</span><span style=\"color:#E1E4E8\">();</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">         let</span><span style=\"color:#E1E4E8\"> componentType;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">         switch</span><span style=\"color:#E1E4E8\"> (</span><span style=\"color:#79B8FF\">this</span><span style=\"color:#E1E4E8\">.contentType) &#123;</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">           case</span><span style=\"color:#9ECBFF\"> 'article'</span><span style=\"color:#E1E4E8\">:</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">             componentType </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> ArticleComponent;</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">             break</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">           case</span><span style=\"color:#9ECBFF\"> 'video'</span><span style=\"color:#E1E4E8\">:</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">             componentType </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> VideoComponent;</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">             break</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">           case</span><span style=\"color:#9ECBFF\"> 'image'</span><span style=\"color:#E1E4E8\">:</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">             componentType </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> ImageComponent;</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">             break</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">         &#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">         if</span><span style=\"color:#E1E4E8\"> (componentType) &#123;</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">           const</span><span style=\"color:#79B8FF\"> factory</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> this</span><span style=\"color:#E1E4E8\">.componentFactoryResolver.</span><span style=\"color:#B392F0\">resolveComponentFactory</span><span style=\"color:#E1E4E8\">(componentType);</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">           this</span><span style=\"color:#E1E4E8\">.contentContainer.</span><span style=\"color:#B392F0\">createComponent</span><span style=\"color:#E1E4E8\">(factory);</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">         &#125;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     &#125;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">   &#125;</span></span></code></pre>\n</li>\n</ol>\n<h2 id=\"最佳实践\">最佳实践</h2>\n<ul>\n<li><strong><a href=\"https://angular.love/lazy-loading-angular-components-from-non-angular-applications\">懒加载</a></strong>：对动态组件使用懒加载，以提高性能。</li>\n<li><strong><a href=\"https://angular.dev/api/core/Input\">Input/Output</a></strong>：使用 <code>@Input()</code> 和 <code>@Output()</code> 在动态组件及其父组件之间传递数据。</li>\n<li><strong><a href=\"https://v17.angular.io/guide/architecture-services\">组件通讯</a></strong>：使用服务或状态管理实现动态组件之间的通信。</li>\n<li><strong><a href=\"https://v17.angular.io/guide/lifecycle-hooks\">声明周期</a></strong>：了解并利用组件生命周期钩子进行状态初始化和监听清理。</li>\n<li><strong><a href=\"https://angular.dev/api/core/ErrorHandler\">错误处理</a></strong>：为动态组件创建和管理提供错误处理功能。</li>\n</ul>\n","text":"在 Angular 中，动态组件允许你在运行时动态地创建和插入组件，而不是在模板中静态定义。这种灵活性使得你可以根据应用的状态或用户交互来决定加载哪些组件。 关...","permalink":"/post/angular-dynamic-component","photos":[],"count_time":{"symbolsCount":"6.3k","symbolsTime":"6 mins."},"categories":[{"name":"ANGULAR","slug":"ANGULAR","count":8,"path":"api/categories/ANGULAR.json"}],"tags":[{"name":"dynamic component","slug":"dynamic-component","count":1,"path":"api/tags/dynamic-component.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%85%B3%E9%94%AE%E8%AF%8D%EF%BC%9A\"><span class=\"toc-text\">关键词：</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%A4%BA%E4%BE%8B-2\"><span class=\"toc-text\">示例</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%8A%A8%E6%80%81%E8%A1%A8%E5%8D%95\"><span class=\"toc-text\">动态表单</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%8A%A8%E6%80%81%E5%BC%B9%E7%AA%97\"><span class=\"toc-text\">动态弹窗</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#CMS%E7%B3%BB%E7%BB%9F%E5%8A%A8%E6%80%81%E5%86%85%E5%AE%B9%E6%B8%B2%E6%9F%93\"><span class=\"toc-text\">CMS系统动态内容渲染</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5\"><span class=\"toc-text\">最佳实践</span></a></li></ol>","author":{"name":"Kidwen","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/38277891?v=4","link":"/","description":"Frontend","socials":{"github":"https://github.com/kidwen","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"使用 cline 生成代码并自动改错","uid":"3080653b62f0f82df186319682e9fc25","slug":"mcp","date":"2025-03-19T07:14:09.384Z","updated":"2025-03-19T07:14:29.542Z","comments":true,"path":"api/articles/mcp.json","keywords":null,"cover":"https://img.kidwen.top/file/AgACAgUAAyEGAASHUuUOAAMaZ9pvfcRXSK1f-YWTjBTLowv3hN8AAujEMRvND9BWoq85kob4kZcBAAMCAAN4AAM2BA.png","text":"mcp全称为Model Context Protocol主要是帮助 AI 与外部的各种工具和数据连接到一起。可以把 MCP 想象成人工智能应用的 “USB-C ...","permalink":"/post/mcp","photos":[],"count_time":{"symbolsCount":"1.6k","symbolsTime":"1 mins."},"categories":[{"name":"AI","slug":"AI","count":2,"path":"api/categories/AI.json"}],"tags":[{"name":"mcp","slug":"mcp","count":1,"path":"api/tags/mcp.json"}],"author":{"name":"Kidwen","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/38277891?v=4","link":"/","description":"Frontend","socials":{"github":"https://github.com/kidwen","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"ssh keygen","uid":"8a8cf02982a981a3981c312011f99772","slug":"ssh-keygen","date":"2025-01-07T09:06:00.000Z","updated":"2025-01-07T09:06:00.000Z","comments":true,"path":"api/articles/ssh-keygen.json","keywords":null,"cover":"https://img.kidwen.top/file/AgACAgUAAyEGAASHUuUOAAMKZ8Uk3Z0SXl4caws_sVUAATJxcK-wAAIxwTEb6dopVs78RNHffPBfAQADAgADeAADNgQ.png","text":"一般来说，一个github账号和一个gitlab账号，需要生成两个公钥和私钥，分别用于github和gitlab。下面介绍如何生成公钥和私钥。并且配置confi...","permalink":"/post/ssh-keygen","photos":[],"count_time":{"symbolsCount":"1.4k","symbolsTime":"1 mins."},"categories":[{"name":"GIT","slug":"GIT","count":2,"path":"api/categories/GIT.json"}],"tags":[{"name":"ssh-keygen","slug":"ssh-keygen","count":1,"path":"api/tags/ssh-keygen.json"}],"author":{"name":"Kidwen","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/38277891?v=4","link":"/","description":"Frontend","socials":{"github":"https://github.com/kidwen","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}