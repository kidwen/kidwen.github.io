{"title":"使用qexo管理hexo博客并自动发布","uid":"01d2f05fbd218c890b1d1ad74fd069bb","slug":"tools/qexo-hexo","date":"2023-09-15T06:20:09.247Z","updated":"2023-09-15T06:42:22.197Z","comments":true,"path":"api/articles/tools/qexo-hexo.json","keywords":null,"cover":"https://s2.loli.net/2023/09/15/9JkGt4v3xwcy6mX.png","content":"<p>本文介绍使用 <code>qexo</code>后台管理 <code>hexo</code>博客并自动推送修改到 <code>github</code>仓库，然后由 <code>github action</code>自动部署并发布。由于我的博客分为两个仓库(博客源码的仓库，静态文件仓库)，所以本文将介绍两个仓库的用法，如果为单仓库可以参考<a href=\"https://hexo.io/docs/github-pages\">hexo github action教程</a>。</p>\n<h2 id=\"准备\"><a href=\"#准备\" class=\"headerlink\" title=\"准备\"></a>准备</h2><ul>\n<li>两个代码仓库</li>\n<li>vercel账号</li>\n<li><a href=\"https://sm.ms/\">sm.ms</a>账号（有自己托管图片的工具则不需要）</li>\n</ul>\n<p><strong>好了，我们开始吧！！！</strong></p>\n<h2 id=\"部署后台管理工具Qexo\"><a href=\"#部署后台管理工具Qexo\" class=\"headerlink\" title=\"部署后台管理工具Qexo\"></a>部署后台管理工具<a href=\"https://www.oplog.cn/qexo/start/build.html#vercel-%E9%83%A8%E7%BD%B2-postgresql-vercel\">Qexo</a></h2><p>qexo是一个有趣的Hexo 编辑器，下面截图是后台管理主界面，可以看到有文章、页面、图片、配置、图片、友链、说说、自定义字段，这些都是对应博客仓库的。右上角有设置对应的是qexo初始化时候的配置信息，使用它我们就可以在线编辑博客啦～</p>\n<p><img src=\"https://s2.loli.net/2023/09/15/ApbOoSXZ8u6IeFC.png\" alt=\"主界面\"></p>\n<h3 id=\"部署Qexo到Vercel\"><a href=\"#部署Qexo到Vercel\" class=\"headerlink\" title=\"部署Qexo到Vercel\"></a>部署Qexo到Vercel</h3><ol>\n<li><p><a href=\"https://vercel.com/new/clone?repository-url=https://github.com/am-abudu/Qexo\"><img src=\"https://vercel.com/button\"></a></p>\n<ul>\n<li>fork 仓库并开始部署</li>\n<li><strong>首次部署会报错, 请无视并继续</strong></li>\n</ul>\n</li>\n<li><p>申请 Vercel 数据库</p>\n<ul>\n<li>进入<a href=\"https://vercel.com/dashboard/stores\">Vercel Storage 界面</a> 然后点击右上角的 Create Database 并选择 Postgres 创建免费 PostgreSQL 数据库, 在 Connect 页面获取数据库连接信息。请注意在地区选择的位置选择与你上一步项目对应的地区（通常为 Washington, D.C., USA (East) - iad1）。</li>\n</ul>\n</li>\n<li><p>绑定项目</p>\n<ul>\n<li>在左侧边栏选择 Projects 点击 Connect Project 连接到第一步创建的项目</li>\n</ul>\n</li>\n<li><p>部署</p>\n<ul>\n<li>回到你的项目页面，在 Deployments 点击 Redeploy 开始部署, 若没有 Error 信息即可打开域名进入初始化引导。</li>\n</ul>\n</li>\n<li><p>配置自定义域名（可选）</p>\n<ul>\n<li>进入vercel创建的项目中点击 <code>Settings</code>选择 <code>Domains</code>添加一个你拥有的域名吧！</li>\n</ul>\n</li>\n</ol>\n<h3 id=\"配置Qexo\"><a href=\"#配置Qexo\" class=\"headerlink\" title=\"配置Qexo\"></a>配置Qexo</h3><ol>\n<li>在浏览器中打开上一步部署的url地址，并输入需要填写的信息，⚠️仓库地址填写博客源码的仓库不要带 <code>https://github.com</code>前缀</li>\n<li>Vercel配置<ul>\n<li>Vercel 账户密钥 在 <a href=\"https://vercel.com/account/tokens\">此处</a> 生成</li>\n<li>Qexo 部署所在项目的 ID 位于 Project Settings -&gt; General -&gt; Project ID</li>\n</ul>\n</li>\n</ol>\n<h3 id=\"配置Qexo图床\"><a href=\"#配置Qexo图床\" class=\"headerlink\" title=\"配置Qexo图床\"></a>配置Qexo图床</h3><p>Qexo支持 <code>远程API</code>、<code>S3协议</code>、<code>FTP协议</code>和 <code>GITHUB</code>(不建议)</p>\n<ol>\n<li><p>我选择的是远程API使用SM.MS来保存图片，<a href=\"https://www.oplog.cn/qexo/practice/smms.html\">教程</a>。但是其中遇到一些问，api调用一直失败json解析报错，原因：设置 -&gt; 图床配置 -&gt; 自定义请求头 <strong><code>&#123;&quot;Authorization&quot;:&quot;XXXXXXXXXXXXXX&quot;&#125;</code>，冒号后面不能有空格！！！</strong></p>\n<ul>\n<li><code>Authorization</code>字段<a href=\"https://sm.ms/home/apitoken\">地址</a></li>\n</ul>\n</li>\n</ol>\n<h2 id=\"代码仓库CI-CD\"><a href=\"#代码仓库CI-CD\" class=\"headerlink\" title=\"代码仓库CI&#x2F;CD\"></a>代码仓库CI&#x2F;CD</h2><ol>\n<li>创建Secrets</li>\n</ol>\n<div class=\"language-bash\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">bash</span><pre class=\"shiki \" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #D8DEE9FF\">   </span><span style=\"color: #88C0D0\">cd</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #A3BE8C\">!/.ssh</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">   </span><span style=\"color: #88C0D0\">ssh-keygen</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #A3BE8C\">-f</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #A3BE8C\">hexo-deploy-key</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #A3BE8C\">-C</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">&#39;</span><span style=\"color: #A3BE8C\">email</span><span style=\"color: #ECEFF4\">&#39;</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">   </span><span style=\"color: #88C0D0\">pbcopy</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">&lt;</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #A3BE8C\">hexo-deploy-key</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #616E88\"># 复制创建的私有key</span></span></code></pre></div>\n2. 配置Secrets\n\n<ul>\n<li><input disabled=\"\" type=\"checkbox\"> 源码仓库Settings -&gt; Secrets -&gt; Actions -&gt; new repository secret添加一个新的 Secret</li>\n</ul>\n<div class=\"language-yml\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">yml</span><pre class=\"shiki \" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #D8DEE9FF\">     </span><span style=\"color: #8FBCBB\">Name</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #A3BE8C\">HEXO_DEPLOY_PRI</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #616E88\"># 名称后面要使用</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">     </span><span style=\"color: #8FBCBB\">Value</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #A3BE8C\">xxxx</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #616E88\"># ~/.ssh/hexo-deploy-key文件中的内容，刚刚已经被复制到剪切板中。</span></span></code></pre></div>\n   - [ ]  静态文件仓库 Settings -> Deploy keys -> add deploy key 页面添加新的 Secret\n\n<div class=\"language-bash\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">bash</span><pre class=\"shiki \" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #D8DEE9FF\">     </span><span style=\"color: #88C0D0\">Title:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #A3BE8C\">hexo-deploy-key</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">     </span><span style=\"color: #88C0D0\">Key:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #A3BE8C\">xxxxx</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #616E88\"># 填入 hexo-deploy-key.pub 中的公钥内容</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">     </span><span style=\"color: #616E88\"># 勾选 Allow write access 选项，允许写入权限</span></span></code></pre></div>\n3. 添加 github action\n\n<ul>\n<li><input disabled=\"\" type=\"checkbox\"> 源码仓库创建文件 <code>.github/workflows/hexo-deploy.yml</code>并编辑</li>\n</ul>\n<div class=\"language-yaml\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">yaml</span><pre class=\"shiki \" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #D8DEE9FF\">     </span><span style=\"color: #8FBCBB\">name</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #A3BE8C\">Hexo Deploy</span></span>\n<span class=\"line\"><span style=\"color: #ECEFF4\">     </span><span style=\"color: #616E88\"># 只监听 source 分支的改动</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">     </span><span style=\"color: #81A1C1\">on</span><span style=\"color: #ECEFF4\">:</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">       </span><span style=\"color: #8FBCBB\">push</span><span style=\"color: #ECEFF4\">:</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">         </span><span style=\"color: #8FBCBB\">branches</span><span style=\"color: #ECEFF4\">:</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">           </span><span style=\"color: #ECEFF4\">-</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #A3BE8C\">master</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ECEFF4\">     </span><span style=\"color: #616E88\"># 自定义环境变量，这个GIT_USER和GIT_EMAIL配置成你自己的，GIT_EMAIL尽量和上面的`ssh-keygen -f hexo-deploy-key -C &quot;email&quot;`中的email保持一致</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">     </span><span style=\"color: #8FBCBB\">env</span><span style=\"color: #ECEFF4\">:</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">       </span><span style=\"color: #8FBCBB\">GIT_USER</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #A3BE8C\">your user name</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">       </span><span style=\"color: #8FBCBB\">GIT_EMAIL</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #A3BE8C\">your email addr</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">     </span><span style=\"color: #8FBCBB\">jobs</span><span style=\"color: #ECEFF4\">:</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">       </span><span style=\"color: #8FBCBB\">build-and-deploy</span><span style=\"color: #ECEFF4\">:</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">         </span><span style=\"color: #8FBCBB\">runs-on</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #A3BE8C\">ubuntu-latest</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">         </span><span style=\"color: #8FBCBB\">steps</span><span style=\"color: #ECEFF4\">:</span></span>\n<span class=\"line\"><span style=\"color: #ECEFF4\">           </span><span style=\"color: #616E88\"># 获取博客源码和主题</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">           </span><span style=\"color: #ECEFF4\">-</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">name</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #A3BE8C\">Checkout</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">             </span><span style=\"color: #8FBCBB\">uses</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #A3BE8C\">actions/checkout@v2</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ECEFF4\">           </span><span style=\"color: #616E88\"># 这里用的是 Node.js 14.x，16.x 生成 Hexo 静态页面会有问题</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">           </span><span style=\"color: #ECEFF4\">-</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">name</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #A3BE8C\">Set up Node.js</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">             </span><span style=\"color: #8FBCBB\">uses</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #A3BE8C\">actions/setup-node@v1</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">             </span><span style=\"color: #8FBCBB\">with</span><span style=\"color: #ECEFF4\">:</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">               </span><span style=\"color: #8FBCBB\">node-version</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">&#39;</span><span style=\"color: #A3BE8C\">16</span><span style=\"color: #ECEFF4\">&#39;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ECEFF4\">           </span><span style=\"color: #616E88\"># 安装依赖</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">           </span><span style=\"color: #ECEFF4\">-</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">name</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #A3BE8C\">Install Dependencies</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">             </span><span style=\"color: #8FBCBB\">run</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">|</span></span>\n<span class=\"line\"><span style=\"color: #A3BE8C\">               npm install</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ECEFF4\">           </span><span style=\"color: #616E88\"># 从之前设置的 secret 获取部署私钥</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">           </span><span style=\"color: #ECEFF4\">-</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">name</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #A3BE8C\">Setup SSH Keys and known_hosts</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">             </span><span style=\"color: #8FBCBB\">env</span><span style=\"color: #ECEFF4\">:</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">               </span><span style=\"color: #8FBCBB\">HEXO_DEPLOY_PRI</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #A3BE8C\">$&#123;&#123; secrets.HEXO_DEPLOY_PRI &#125;&#125;</span><span style=\"color: #D8DEE9FF\"> </span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">             </span><span style=\"color: #8FBCBB\">run</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">|</span></span>\n<span class=\"line\"><span style=\"color: #A3BE8C\">               sudo timedatectl set-timezone &quot;Asia/Shanghai&quot;</span></span>\n<span class=\"line\"><span style=\"color: #A3BE8C\">               mkdir -p ~/.ssh</span></span>\n<span class=\"line\"><span style=\"color: #A3BE8C\">               echo &quot;$HEXO_DEPLOY_PRI&quot; &gt; ~/.ssh/id_rsa</span></span>\n<span class=\"line\"><span style=\"color: #A3BE8C\">               chmod 600 ~/.ssh/id_rsa</span></span>\n<span class=\"line\"><span style=\"color: #A3BE8C\">               ssh-keyscan github.com &gt;&gt; ~/.ssh/known_hosts</span></span>\n<span class=\"line\"><span style=\"color: #A3BE8C\">               git config --global user.name $GIT_USER</span></span>\n<span class=\"line\"><span style=\"color: #A3BE8C\">               git config --global user.email $GIT_EMAIL</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ECEFF4\">           </span><span style=\"color: #616E88\"># 生成并部署 `npx hexo clean &amp;&amp; npx hexo g -d` or `npm run deploy`</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">           </span><span style=\"color: #ECEFF4\">-</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">name</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #A3BE8C\">Deploy</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">             </span><span style=\"color: #8FBCBB\">run</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">|</span></span>\n<span class=\"line\"><span style=\"color: #A3BE8C\">               npx hexo clean &amp;&amp; npx hexo g &amp;&amp; npx hexo deploy</span></span></code></pre></div>\n","feature":true,"text":"本文介绍使用 qexo后台管理 hexo博客并自动推送修改到 github仓库，然后由 github action自动部署并发布。由于我的博客分为两个仓库(博客...","permalink":"/post/tools/qexo-hexo","photos":[],"count_time":{"symbolsCount":"3.3k","symbolsTime":"3 mins."},"categories":[{"name":"TOOL","slug":"TOOL","count":8,"path":"api/categories/TOOL.json"}],"tags":[{"name":"qexo","slug":"qexo","count":1,"path":"api/tags/qexo.json"},{"name":"hexo","slug":"hexo","count":1,"path":"api/tags/hexo.json"},{"name":"ci/cd","slug":"ci-cd","count":1,"path":"api/tags/ci-cd.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%87%86%E5%A4%87\"><span class=\"toc-text\">准备</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%83%A8%E7%BD%B2%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7Qexo\"><span class=\"toc-text\">部署后台管理工具Qexo</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%83%A8%E7%BD%B2Qexo%E5%88%B0Vercel\"><span class=\"toc-text\">部署Qexo到Vercel</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%85%8D%E7%BD%AEQexo\"><span class=\"toc-text\">配置Qexo</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%85%8D%E7%BD%AEQexo%E5%9B%BE%E5%BA%8A\"><span class=\"toc-text\">配置Qexo图床</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BB%A3%E7%A0%81%E4%BB%93%E5%BA%93CI-CD\"><span class=\"toc-text\">代码仓库CI&#x2F;CD</span></a></li></ol>","author":{"name":"Kidwen","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/38277891?v=4","link":"/","description":"Frontend","socials":{"github":"https://github.com/kidwen","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{},"next_post":{"title":"angular v16 signal api 介绍","uid":"67a0811293cd2bc9df0f8e11e20e867f","slug":"frontend/angular-signal-api","date":"2023-07-21T08:00:00.000Z","updated":"2023-09-15T06:42:22.197Z","comments":true,"path":"api/articles/frontend/angular-signal-api.json","keywords":null,"cover":"/images/angular-signal-api.webp","text":"本文介绍 Angular signal库的 API 接口和一些实现细节。 signal在Angular中是一种具有明确变更语义的值。在 Angular 中，si...","permalink":"/post/frontend/angular-signal-api","photos":[],"count_time":{"symbolsCount":"13k","symbolsTime":"12 mins."},"categories":[{"name":"FRONTEND","slug":"FRONTEND","count":7,"path":"api/categories/FRONTEND.json"}],"tags":[{"name":"angular","slug":"angular","count":4,"path":"api/tags/angular.json"}],"author":{"name":"Kidwen","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/38277891?v=4","link":"/","description":"Frontend","socials":{"github":"https://github.com/kidwen","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true}}